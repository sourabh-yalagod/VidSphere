import{w as y,r as c,m as p,b as g,j as r,L as f,d as n}from"./index-UvYE2vCo.js";import{u as w}from"./useQuery-CrBritpR.js";import{u as j}from"./useMutation-CwDNoP1B.js";import{A as v}from"./APIError-D9d9TDrV.js";import{S as b}from"./Skeleton-DeC67vp7.js";import{V as k}from"./Video-zesbP1DF.js";import{T as H}from"./trash-2-BPVHwrC3.js";import"./useBaseQuery-HSbBb3vM.js";import"./utils-km2FGkQ4.js";import"./eye-off-8sHzMaHp.js";import"./ellipsis-vertical-BigcdGfO.js";import"./loader-circle-DSk3sBJA.js";const Q=()=>{var o;const{userId:l}=y(),[e,d]=c.useState(""),u=p(),{toast:s}=g(),m=async()=>{const t=await n.get(`https://videotube-auro.onrender.com/api/v1/users/watch-history/${l}`);return t==null?void 0:t.data},{data:a,isPending:h,error:x}=w({queryKey:["watchHistoryVideos"],queryFn:m,staleTime:5*60*1e3});c.useEffect(()=>{d(a==null?void 0:a.data)},[a]);const i=j({mutationFn:async()=>{const t=await n.put("https://videotube-auro.onrender.com/api/v1/videos/clear-watchhistory");return t==null?void 0:t.data},onSuccess:()=>{u.invalidateQueries({queryKey:["watchHistoryVideos"]}),s({title:"Watch history cleared successfully!",description:`At ${new Date().toLocaleString()}`,variant:"default",duration:1200})},onError:()=>{s({title:"Error clearing watch history!",description:`At ${new Date().toLocaleString()}`,variant:"destructive",duration:1200})}});return h?r.jsx(b,{cards:15}):x?r.jsx(v,{}):r.jsxs("div",{className:"min-h-screen w-full p-5 bg-white dark:bg-black relative",children:[r.jsxs("button",{className:"p-2 border-gray-300 flex gap-2 my-4 border-[1px] dark:border-slate-700 rounded-xl text-gray-700 dark:text-slate-300",onClick:()=>i.mutate(),children:[i.isPending&&r.jsx(f,{className:"animate-spin"}),"Clear Watch History"]}),r.jsx("div",{className:"w-full min-h-auto grid",children:((o=e==null?void 0:e.videos)==null?void 0:o.length)>0?r.jsx("ul",{className:"grid w-full gap-2 place-items-center sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:e.videos.map(t=>r.jsx("div",{className:"flex-1 min-w-[320px] max-w-[450px] border-slate-700 border p-2 rounded-xl relative",children:r.jsx(k,{video:t,userId:t==null?void 0:t.owner,avatar:e==null?void 0:e.avatar,username:e==null?void 0:e.username})},t._id))}):r.jsxs("div",{className:"text-3xl flex gap-5 w-full justify-center items-centerw text-center text-gray-700 dark:text-white my-auto",children:[r.jsx(H,{className:"text-gray-700 dark:text-white size-12 text-center"}),r.jsx("p",{children:"Watch history is empty..."})]})})]})};export{Q as default};
